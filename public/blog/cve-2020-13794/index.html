<!DOCTYPE html>
<html lang="en-us"><head>
  <!-- Basic Page Needs -->
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  
  <meta name="description" content="CVE-2020-13794 discovered by Hidde Smit">
  <meta name="author" content="Cyber Eagle | Hidde Smit">
  <meta name="generator" content="Cyber Eagle | Hidde Smit">
  
  <!-- Mobile Specific Metas -->
  <meta name="format-detection" content="telephone=no">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CVE-2020-13794 Harbor User Enumeration Vulnerability</title>
  <link rel="icon" href="https://www.cybereagle.io/images/favicon.ico">

  <!-- Twitter Bootstrs CSS -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/bootstrap/bootstrap.min.css">
  <!-- Ionicons Fonts Css -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/ionicons/ionicons.min.css">
  <!-- animate css -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/animate-css/animate.css">
  <!-- Hero area slider css-->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/slider/slider.css">
  <!-- slick slider -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/slick/slick.css">
  <!-- Fancybox -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/facncybox/jquery.fancybox.css">
  <!-- hover -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/hover/hover-min.css">
  <!-- template main css file -->
  
  <link rel="stylesheet" href="https://www.cybereagle.io/css/style.min.css" integrity="" media="screen">
</head><body><section class="top-bar animated-header">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<nav class="navbar navbar-expand-lg navbar-light bg-light">
					<a class="navbar-brand" href="https://www.cybereagle.io/">
						<img src="https://www.cybereagle.io/images/logo.png" alt="Cyber Eagle | Professional penetration testing services">
					</a>
					<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation"
						aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>

					<div class="collapse navbar-collapse" id="navigation">
						<ul class="navbar-nav ml-auto">
							<li class="nav-item">
								<a class="nav-link" href="https://www.cybereagle.io/">Home</a>
							</li>
							
							<li class="nav-item">
								<a class="nav-link" href="https://www.cybereagle.io/blog">Blog</a>
							</li>
							
							<li class="nav-item">
								<a class="nav-link" href="https://www.cybereagle.io/contact">Contact</a>
							</li>
							
						</ul>
					</div>
				</nav>
			</div>
		</div>
	</div>
</section>

<section class="global-page-header">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2>CVE-2020-13794 Harbor User Enumeration Vulnerability</h2>
                    <div class="portfolio-meta">
                        <span>Wednesday, Sep 16, 2020</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="single-post">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                
                <div class="post-content">
                    <h1 id="harbor">Harbor</h1>
<p>During a recent pentest engagement, one of my targets was Harbor. The version tested was 1.9.3 however, this vulnerability most likely works on earlier versions as well.</p>
<p>A non-administrator account was provided during the pentest engagement.</p>
<blockquote>
<p>Harbor is an open source trusted cloud native registry project that stores, signs, and scans content. Harbor extends the open source Docker Distribution by adding the functionalities usually required by users such as security, identity and management. Having a registry closer to the build and run environment can improve the image transfer efficiency. Harbor supports replication of images between registries, and also offers advanced security features such as user management, access control and activity auditing.<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
</blockquote>
<h2 id="security-advisories">Security Advisories</h2>
<p>While analyzing the target I decided to look up security advisories posted on <a href="https://github.com/goharbor/harbor/security/advisories">github</a>.
Even though the security advisories contain patched vulnerabilities, they can provide insight and inspiration for potential undiscovered vulnerabilities.</p>
<p>One security advisory which caught my eye is an <a href="https://github.com/goharbor/harbor/security/advisories/GHSA-6qj9-33j4-rvhg">user enumeration vulnerability</a>.
It is a pretty straight forward vulnerability where you send a request to the search API endpoint containing an e-mail or part of it and in return, you receive a response containing user information.</p>
<p>An example given in the security advisory:</p>
<p><code>curl -X GET &quot;http://&lt;host&gt;/api/users/search?email=test@test.com&quot; -H &quot;accept: application/json&quot; --user &lt;user&gt;:&lt;password&gt;</code></p>
<h2 id="finding-a-new-vulnerability">Finding a new vulnerability</h2>
<p>Having the user enumeration vulnerability security advisory in mind. I decided to try and find other query strings that might result in a similar vulnerability. This can easily be tested using Burp Suite&rsquo;s intruder or just any tool would do.</p>
<p>One query string which seemed to work is username. It is possible to list all users containing a given letter using the following cURL command:</p>
<p><code>curl -X GET &quot;http://&lt;host&gt;/api/users/search?username=X&quot; -H &quot;accept: application/json&quot; --user &lt;user&gt;:&lt;password&gt;</code></p>
<p>My next attempt was to find a wildcard character to display all users available. After running every single character through the cURL request the following cURL request seemed to display all users currently registered:</p>
<p><code>curl -X GET &quot;http://&lt;host&gt;/api/users/search?username=_&quot; -H &quot;accept: application/json&quot; --user &lt;user&gt;:&lt;password&gt;</code></p>
<p>As shown in the example above, the underscore character acts as a wildcard character.</p>
<p>The information given by this API is an <code>user_id</code> and <code>username</code>. During the pentest engagement, most of the usernames discovered contained e-mail addresses. Providing a nice list of targets for social engineering attacks.</p>
<p>After discovering this vulnerability I informed Harbor Security Team, they confirmed the vulnerability which has been assigned to CVE-2020-13794.</p>
<h2 id="remediation">Remediation</h2>
<p>The Harbor Security Team has published a security advisory regarding this vulnerability (<a href="https://github.com/goharbor/harbor/security/advisories/GHSA-q9p8-33wc-h432">GHSA-q9p8-33wc-h432</a>).</p>
<p>This issue is resolved in version 2.1.0 and 2.0.3.</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><a href="https://github.com/goharbor/harbor">https://github.com/goharbor/harbor</a> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

                </div>
            </div>
        </div>
    </div>
</section>


<!-- Call To Action Section Start -->
<section id="call-to-action">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2 class="title wow fadeInDown" data-wow-delay=".3s" data-wow-duration="500ms">LOOKING FOR A SECURITY ASSESSMENT ?</h2>
                    <p class="wow fadeInDown" data-wow-delay=".5s" data-wow-duration="500ms">Don't hesitate to contact me!</p>
                    <a href="/contact" class="btn btn-default btn-contact wow fadeInDown" data-wow-delay=".7s" data-wow-duration="500ms">Contact me</a>
                </div>
            </div>

        </div>
    </div>
</section>
<!-- Call To Action Section End -->


<!-- Footer Section Start -->
<footer id="footer">
    <div class="container">
        <div class="row content-justify-between">
            <div class="col-md-8 col-12 text-center text-lg-left text-md-left">
                <p class="copyright">Copyright Â© 
                    <span>
                        <script>document.write(new Date().getFullYear())</script>
                    </span> Cyber Eagle
                </p>
            </div>
            <div class="col-md-4 col-12">
                <!-- Social Media -->
                <ul class="social text-center text-md-right text-lg-right">
                    
                    <li><a href="https://www.linkedin.com/in/hiddes/"><i class="ion-social-linkedin"></i></a></li>
                    
                </ul>
            </div>
        </div>
    </div>
</footer>
<!-- footer section end -->

<!-- jquery -->
<script src="https://www.cybereagle.io/plugins/jQurey/jquery.min.js"></script>
<!-- Form Validation -->
<script src="https://www.cybereagle.io/plugins/form-validation/jquery.form.js"></script>
<script src="https://www.cybereagle.io/plugins/form-validation/jquery.validate.min.js"></script>
<!-- slick slider -->
<script src="https://www.cybereagle.io/plugins/slick/slick.min.js"></script>
<!-- bootstrap js -->
<script src="https://www.cybereagle.io/plugins/bootstrap/bootstrap.min.js"></script>
<!-- wow js -->
<script src="https://www.cybereagle.io/plugins/wow-js/wow.min.js"></script>
<!-- slider js -->
<script src="https://www.cybereagle.io/plugins/slider/slider.js"></script>
<!-- Fancybox -->
<script src="https://www.cybereagle.io/plugins/facncybox/jquery.fancybox.js"></script>
<!-- template main js -->

<script src="https://www.cybereagle.io/js/script.min.js"></script>
<!-- google analitycs -->
</body>
</html>